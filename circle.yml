machine:
  services:
    - docker
dependencies:
  cache_directories:
    - ~/.bosonstate
  override:
    - ./setup.sh
    - ./build.sh https://api.github.com/repos/Sabayon/sabayon-distro/commits/master ~/.bosonstate/sabayon-distro-current_commit ~/.bosonstate/sabayon-distro-last_commit sabayon-distro-amd64.boson
    - ./build.sh https://api.github.com/repos/Sabayon/for-gentoo/commits/master ~/.bosonstate/for-gentoo-current_commit ~/.bosonstate/for-gentoo-last_commit for-gentoo-amd64.boson
test:
  override:
    - if [[ ! -e /artifacts_dir ]]; then sudo cp -rvf /artifacts_dir/* $CIRCLECI_ARTIFACTS/; fi
    - sudo mkdir -p $CIRCLECI_ARTIFACTS/logs
    - if [[ ! -e /log_dir ]]; then sudo cp -rvf /log_dir/* $CIRCLECI_ARTIFACTS/logs/; fi
